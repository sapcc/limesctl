binaries:
  - name:        limesctl
    fromPackage: .
    installTo:   bin/

vendoring:
  enabled: false

variables:
  GO_LDFLAGS: '-X main.version=$(VERSION) -X main.gitCommitHash=$(GIT_COMMIT_HASH)'

verbatim: |
  VERSION         := $(shell git describe --long --abbrev=7)
  GIT_COMMIT_HASH := $(shell git rev-parse --verify HEAD)

  lint: FORCE
    @printf "\e[1;36m>> golangci-lint\e[0m\n"
    @command -v golangci-lint >/dev/null 2>&1 || { echo >&2 "Error: golangci-lint is not installed. See: https://golangci-lint.run/usage/install/"; exit 1; }
    golangci-lint run
  check: lint # attach `make lint` as a dependency to the autogenerated `make check`

  build/release-info: CHANGELOG.md
    @mkdir -p build
    go run $(GO_BUILDFLAGS) tools/releaseinfo/main.go $< $(shell git describe --tags --abbrev=0) > $@
